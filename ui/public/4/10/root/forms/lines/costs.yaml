---
  id: costs
  method: POST
  attrs: { name: 'costsForm', class: 'inner mform' }
  output_processors: [ Indent ]
  auto_id: '%f_%n'
  languages: [ ru ]
  model_config:
    resultset: Costs

  default_args:
    elements:
      Text:
        filters:
          - type: TrimEdges

  constraints:
    - type: Number
      name: costs
      message: "Поле должно быть числовым значением, разделитель - точка"

  inflators:
    - type: DateTime
      name: date
      parser:
        strptime: '%Y-%m-%d'
      strptime:
        pattern: '%Y-%m-%d'
      locale: ru

  deflator:
    - type: Strftime
      name: date
      strftime: '%Y-%m-%d'

  validators:
    - type: '+BampoManager::FormFu::Validator::Costs::Date'
      name: date
      message: "дата не позже вчера"

    - type: '+BampoManager::FormFu::Validator::Costs::Amount'
      name: costs
      message: "Поле должно быть числовым значением, разделитель - точка"

  attributes:
    onsubmit: "return false"

  elements:
    - type: Hidden
      name: lineId
      force_default: 1

    - type: Text
      name: line_title
      label: "Название размещения:"
      attrs: { class: '', readonly: 1 }
      force_default: 1

    - type: Multi
      label: "Дата:"
      container_tag: div
      container_attributes:
        class: dropdown_input
        id: date_holder
      javascript: "initDateSelect({elmValue: 'date', holder: '#date_holder', extra: {maxDate: '-1d', onSelect: function() {reload_dialog(dialog_url, 'd_costs', {date: $('costs_dialog_date').value, reload_form: 1})} }});"
      elements:
        - type: Hidden
          name: date
          id: costs_dialog_date

    - type: Text
      name: costs
      id:   costs_dialog_costs
      label: "Затраты:"
      attrs: { class: '' }
      force_default: 1

    - type: Multi
      elements:
        - type: Submit
          value: Сохранить
          attributes_xml:
            onclick: "var costs = $('costs_dialog_costs'); if (isNaN(parseInt(costs.value,10)) || parseInt(costs.value,10) < 0 || (parseInt(costs.value,10) >= parseInt((costs.defaultValue || 0),10)) || confirm('Изменить величину затрат на меньшее значение?')) submit_dialog(this.form,'d_costs');"

        - type: Reset
          value: Отмена
          attributes_xml:
            onclick: hideDialog('d_costs')
